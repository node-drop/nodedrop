# Edition: "community" (self-hosted) or "cloud" (SaaS)
NODEDROP_EDITION=community

# Database
DATABASE_URL="postgresql://username:password@localhost:5432/node_drop"
TEST_DATABASE_URL="postgresql://username:password@localhost:5432/node_drop_test"

# Database Connection Pooling (Production)
# Maximum connections in pool (default: 20 for production, 10 for development)
# DB_POOL_MAX=20
# Minimum connections to maintain (default: 5 for production, 2 for development)
# DB_POOL_MIN=5
# Idle connection timeout in milliseconds (default: 30000 for production, 10000 for development)
# DB_IDLE_TIMEOUT_MS=30000
# Connection acquisition timeout in milliseconds (default: 5000)
# DB_CONNECTION_TIMEOUT_MS=5000
# Recycle connections after N uses (production only, default: 7500)
# DB_MAX_USES=7500

# Database SSL/TLS Configuration (Production)
# Enable SSL for database connections (default: true in production, false in development)
# DB_SSL=true
# Reject unauthorized SSL certificates (default: true in production)
# DB_SSL_REJECT_UNAUTHORIZED=true
# Base64-encoded CA certificate for custom SSL verification
# DB_SSL_CA="base64-encoded-ca-certificate"
# Base64-encoded client certificate for mutual TLS
# DB_SSL_CERT="base64-encoded-client-certificate"
# Base64-encoded client key for mutual TLS
# DB_SSL_KEY="base64-encoded-client-key"

# Database Query Logging
# Enable query logging (default: true in development, false in production)
# DB_LOG_QUERIES=false
# Log connection pool events (development only)
# DB_LOG_CONNECTIONS=false

# Drizzle ORM Configuration
DRIZZLE_SCHEMA_PATH="./src/db/schema"
DRIZZLE_MIGRATIONS_PATH="./src/db/migrations"

# Redis
REDIS_URL="redis://localhost:6379"

# Socket.IO Redis Adapter
# Enable Redis adapter for Socket.IO to support horizontal scaling (default: false)
ENABLE_SOCKET_REDIS_ADAPTER=false
# Event buffer retention time in milliseconds (default: 60000 = 60 seconds)
SOCKET_BUFFER_RETENTION_MS=60000
# Maximum number of execution buffers to maintain (default: 100)
SOCKET_MAX_BUFFERED_EXECUTIONS=100
# Maximum events per execution buffer (default: 20)
SOCKET_MAX_EVENTS_PER_EXECUTION=20

# JWT
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"
JWT_EXPIRES_IN="7d"

# Server
PORT=4000
NODE_ENV="development"

# Logging
LOG_LEVEL="info"

# File Storage
UPLOAD_DIR="./uploads"
TEMP_DIR="./temp"

# Security
BCRYPT_ROUNDS=10
ENCRYPTION_KEY="your-32-character-encryption-key-here"

# Git Integration
# Directory for storing local Git repositories (default: ./git-repos)
GIT_STORAGE_DIR="./git-repos"
# Encryption key for Git credentials (default: uses ENCRYPTION_KEY)
GIT_ENCRYPTION_KEY="your-32-character-git-encryption-key"
# Git operation timeout in milliseconds (default: 30000)
GIT_OPERATION_TIMEOUT=30000
# Maximum repository size in bytes (default: 104857600 = 100MB)
GIT_MAX_REPO_SIZE=104857600
# Maximum number of commits to fetch in history (default: 100)
GIT_MAX_HISTORY_COMMITS=100

# Git OAuth Providers (optional - leave empty to disable)
# GitHub OAuth for Git operations
GITHUB_GIT_CLIENT_ID=""
GITHUB_GIT_CLIENT_SECRET=""
GITHUB_OAUTH_CALLBACK_URL="/api/git/oauth/github/callback"

# GitLab OAuth for Git operations
GITLAB_CLIENT_ID=""
GITLAB_CLIENT_SECRET=""
GITLAB_OAUTH_CALLBACK_URL="/api/git/oauth/gitlab/callback"

# Bitbucket OAuth for Git operations
BITBUCKET_CLIENT_ID=""
BITBUCKET_CLIENT_SECRET=""
BITBUCKET_OAUTH_CALLBACK_URL="/api/git/oauth/bitbucket/callback"

# External Services
WEBHOOK_BASE_URL="http://localhost:4000/webhook"

# Development
ENABLE_CORS=true
CORS_ORIGIN="http://localhost:3000"

# Rate Limiting
# Form Fetch Rate Limiting (GET requests)
FORM_FETCH_WINDOW_MS=60000        # 1 minute
FORM_FETCH_MAX_REQUESTS=30        # 30 requests per window

# Form Submit Rate Limiting (POST requests)
FORM_SUBMIT_WINDOW_MS=900000      # 15 minutes
FORM_SUBMIT_MAX_REQUESTS=5        # 5 submissions per window

# General API Rate Limiting
API_WINDOW_MS=60000               # 1 minute
API_MAX_REQUESTS=100              # 100 requests per window

# Authentication Rate Limiting
AUTH_WINDOW_MS=900000             # 15 minutes
AUTH_MAX_REQUESTS=5               # 5 attempts per window

# Rate Limiting Control
RATE_LIMIT_ENABLED=true           # Enable/disable rate limiting globally
RATE_LIMIT_SKIP_LOCALHOST=true    # Skip localhost in development mode

# OAuth Providers (optional - leave empty to disable)
# Google OAuth
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# GitHub OAuth
GITHUB_CLIENT_ID=""
GITHUB_CLIENT_SECRET=""

# better-auth Configuration
# Session secret for signing cookies (required in production)
BETTER_AUTH_SECRET="your-better-auth-secret-change-in-production"

# Execution Queue System
# Number of concurrent workflow executions per worker (default: 5)
EXECUTION_WORKER_CONCURRENCY=5
# TTL for active execution state in Redis in seconds (default: 86400 = 24 hours)
EXECUTION_STATE_TTL=86400
# TTL for completed execution state in Redis in seconds (default: 3600 = 1 hour)
EXECUTION_COMPLETION_TTL=3600